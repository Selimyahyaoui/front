<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Assets (T_AssetReport)</title>
  <link rel="stylesheet" href="/static/style.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
</head>
<body>

<header class="hero">
  <div class="hero__brand">
    <img src="/static/bnp_logo.png" alt="BNP" class="logo">
    <div>
      <h1>Assets (inventaire)</h1>
      <div class="sub">Liste issue de <code>T_AssetReport</code></div>
    </div>
  </div>

  <form class="hero__tools" method="get" action="/assets">
    <div class="input">
      <input type="text" name="q" value="{{ q }}" placeholder="Rechercher (serial, CFI, modèle, PO, client)">
    </div>
    <div class="select">
      <label for="per_page">Par page</label>
      <select id="per_page" name="per_page">
        <option value="10" {% if per_page==10 %}selected{% endif %}>10</option>
        <option value="20" {% if per_page==20 %}selected{% endif %}>20</option>
        <option value="50" {% if per_page==50 %}selected{% endif %}>50</option>
        <option value="100" {% if per_page==100 %}selected{% endif %}>100</option>
      </select>
    </div>
    <button class="btn" type="submit">Chercher</button>
    <a class="btn btn--ghost" href="/">Accueil</a>
  </form>
</header>

<main class="content">
  <div class="card scroll-x">
    <table class="tbl">
      <thead>
      <tr>
        <th>ID</th>
        <th>Date ajout</th>
        <th>Serial</th>
        <th>CFI code</th>
        <th>Région</th>
        <th>CFI name</th>
        <th>Client #</th>
        <th>Client</th>
        <th>CPU</th>
        <th>Sockets</th>
        <th>Cœurs</th>
        <th>Modèle</th>
        <th>Adresse client</th>
        <th>Code postal</th>
        <th>Pays</th>
        <th>Order #</th>
        <th>PO</th>
        <th>BMC MAC</th>
        <th>Mémoire (MB)</th>
        <th>HBA</th>
        <th>BOSS</th>
        <th>PERC</th>
        <th>NVMe</th>
        <th>GPU</th>
        <th>Disques (JSON)</th>
        <th>MAC/NIC (JSON)</th>
      </tr>
      </thead>
      <tbody>
      {% for a in assets %}
        <tr>
          <td>{{ a.id }}</td>
          <td>{{ a.date_add }}</td>
          <td>{{ a.serial }}</td>
          <td>{{ a.cfi_code }}</td>
          <td>{{ a.region }}</td>
          <td>{{ a.cfi_name }}</td>
          <td>{{ a.customer_number }}</td>
          <td>{{ a.customer_name }}</td>
          <td>{{ a.cpu }}</td>
          <td>{{ a.sockets }}</td>
          <td>{{ a.cores }}</td>
          <td>{{ a.model }}</td>
          <td>{{ a.customer_address }}</td>
          <td>{{ a.postcode }}</td>
          <td>{{ a.country }}</td>
          <td>{{ a.order_number }}</td>
          <td>{{ a.po_number }}</td>
          <td><code>{{ a.bmc_mac }}</code></td>
          <td>{{ a.memory }}</td>

          {% macro yesno(v) -%}
            <span class="badge {{ 'badge--yes' if v else 'badge--no' }}">{{ 'Oui' if v else 'Non' }}</span>
          {%- endmacro %}

          <td>{{ yesno(a.hba) }}</td>
          <td>{{ yesno(a.boss) }}</td>
          <td>{{ yesno(a.perc) }}</td>
          <td>{{ yesno(a.nvme) }}</td>
          <td>{{ yesno(a.gpu) }}</td>

          <td class="truncate" title="{{ a.hdd_json }}">{{ a.hdd_json }}</td>
          <td class="truncate" title="{{ a.mac_nic_json }}">{{ a.mac_nic_json }}</td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>

  <div class="pagination">
    {% set last = (total // per_page) + (1 if (total % per_page) else 0) %}
    {% if page > 1 %}
      <a class="btn btn--ghost" href="/assets?q={{ q }}&per_page={{ per_page }}&page={{ page-1 }}">Précédent</a>
    {% endif %}
    <span>Page {{ page }} / {{ last if last>0 else 1 }}</span>
    {% if (page * per_page) < total %}
      <a class="btn btn--ghost" href="/assets?q={{ q }}&per_page={{ per_page }}&page={{ page+1 }}">Suivant</a>
    {% endif %}
    <span class="hint">Total: {{ total }}</span>
  </div>
</main>

</body>
</html>
