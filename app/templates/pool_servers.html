<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Pool serveurs</title>
  <link rel="stylesheet" href="/static/style.css" />
  <style>
    .header-bar { background:#fff; border-bottom:1px solid #e5e7eb; }
    .wrap      { max-width:1200px; margin:0 auto; padding:16px; }
    .brand { display:flex; align-items:center; gap:12px; }
    .brand img { height:36px; }
    .brand h1 { font-size:22px; margin:0; font-weight:700; color:#0b3d2e; }

    .controls { display:flex; gap:8px; align-items:center; margin:12px 0 16px; }
    .controls .spacer { flex:1; }
    .controls input[type="text"]{
      padding:8px 10px; border:1px solid #e5e7eb; border-radius:8px; width:320px;
    }
    .btn { padding:8px 12px; border:1px solid #d1d5db; border-radius:8px; background:#fff; cursor:pointer; }
    .btn.primary { background:#0ea5e9; color:#fff; border-color:#0ea5e9; }
    .btn.linklike { background:#f9fafb; }

    .card { background:#fff; border:1px solid #e5e7eb; border-radius:12px; padding:12px; }
    table { width:100%; border-collapse:collapse; }
    th, td { border-bottom:1px solid #f1f5f9; padding:10px 12px; text-align:left; vertical-align:top; }
    th { background:#f8fafc; font-weight:600; white-space:nowrap; position:sticky; top:0; z-index:1; }
    .badge { display:inline-block; padding:2px 10px; font-size:12px; font-weight:700; border-radius:999px; }
    .yes { background:#dcfce7; color:#166534; border:1px solid #86efac; }
    .no  { background:#fee2e2; color:#991b1b; border:1px solid #fecaca; }
    .dash{ color:#94a3b8; }
    .table-container { overflow:auto; max-height:70vh; border-radius:12px; }
    .foot { display:flex; justify-content:space-between; color:#475569; padding-top:10px; font-size:14px; }
  </style>
</head>
<body>

  <!-- header identical spirit to catalog -->
  <div class="header-bar">
    <div class="wrap">
      <div class="brand">
        <img src="/static/bnp_logo.png" alt="BNP Paribas" />
        <h1>Pool serveurs</h1>
      </div>

      <form class="controls" method="get" action="/pool_servers">
        <div class="spacer"></div>
        <input type="text" name="q" value="{{ q }}" placeholder="Rechercher (serial, équipement, zone, ...)" />
        <label for="per_page" class="sr-only">Par page</label>
        <select id="per_page" name="per_page" onchange="this.form.submit()">
          <option value="10"  {% if per_page == 10 %}selected{% endif %}>10</option>
          <option value="20"  {% if per_page == 20 %}selected{% endif %}>20</option>
          <option value="50"  {% if per_page == 50 %}selected{% endif %}>50</option>
          <option value="100" {% if per_page == 100 %}selected{% endif %}>100</option>
        </select>
        <button class="btn primary" type="submit">Chercher</button>
        <a class="btn linklike" href="/">Accueil</a>
      </form>
    </div>
  </div>

  <div class="wrap">
    <div class="card table-container">
      <table>
        <thead>
          <tr>
            {% for h in headers %}
              <th title="{{ h.raw }}">{{ h.title }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          {% for row in rows %}
            <tr>
              {% for h in headers %}
                {% set key = h.raw %}
                {% set val = row.get(key) %}
                <td>
                  {% if key in bool_cols %}
                    {% if val is none %}
                      <span class="dash">—</span>
                    {% elif val %}
                      <span class="badge yes">Oui</span>
                    {% else %}
                      <span class="badge no">Non</span>
                    {% endif %}
                  {% else %}
                    {{ val if val is not none and val|string|length > 0 else "—" }}
                  {% endif %}
                </td>
              {% endfor %}
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="foot">
      <div>Total: {{ total }}</div>
      <div>
        {% if page > 1 %}
          <a class="btn" href="/pool_servers?page={{ page - 1 }}&per_page={{ per_page }}&q={{ q }}">Précédent</a>
        {% endif %}
        <span>Page {{ page }}</span>
        {% if (page * per_page) < total %}
          <a class="btn" href="/pool_servers?page={{ page + 1 }}&per_page={{ per_page }}&q={{ q }}">Suivant</a>
        {% endif %}
      </div>
    </div>
  </div>

</body>
</html>
